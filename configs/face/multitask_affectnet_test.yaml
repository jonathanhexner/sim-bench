# Quick test config for Phase 2 Multitask Pretraining
# Uses train folder for both train/val, runs only a few batches

seed: 42
device: "cpu"

data:
  train_dir: "D:/DataSets/AffectNet/train"
  val_dir: null  # Auto-split from train
  val_split: 0.1
  landmarks_cache: cache/affectnet_landmarks.json  # Use landmarks if available
  num_workers: 0  # Single process for debugging

model:
  backbone: "resnet18"  # Smaller for faster testing
  pretrained: true
  embedding_dim: 512
  num_expression_classes: 8
  num_landmarks: 5
  dropout: 0.0
  use_uncertainty_weighting: true

transform:
  input_size: 224
  normalize_mean: [0.485, 0.456, 0.406]
  normalize_std: [0.229, 0.224, 0.225]
  augmentation:
    horizontal_flip: 0.5
    color_jitter:
      brightness: 0.1
      contrast: 0.1
      saturation: 0.1
      hue: 0.05

training:
  batch_size: 8
  learning_rate: 0.001
  differential_lr: true
  optimizer: "adamw"
  weight_decay: 0.0001
  max_epochs: 1

  scheduler:
    type: "cosine"
    T_max: 1
    eta_min: 0.00001
    warmup_epochs: 0

# Quick test: limit batches
max_batches: 5  # Only run 5 batches per epoch

output_dir: null
checkpoint_interval: 1
log_interval: 1
