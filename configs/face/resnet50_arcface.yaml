# Face Recognition Training Configuration
# Dataset: CASIA-WebFace
# Model: ResNet-50 + ArcFace

# Reproducibility
seed: 42

# Device configuration
device: "cuda"  # or "cpu"

# Data configuration
data:
  data_format: "recordio"  # "recordio" or "folder"
  rec_path: "D:/DataSets/casia_Webface/casia-webface/train.rec"
  num_classes: 10572  # CASIA-WebFace rec file has 10,431 identities
  val_ratio: 0.05  # 5% for validation (face datasets are large)
  num_workers: 4

# Model configuration
model:
  backbone: "resnet50"
  pretrained: true  # ImageNet pretrained
  embedding_dim: 512  # Standard for face recognition
  num_classes: 10572
  dropout: 0.0
  arcface_margin: 0.5  # ~28.6 degrees
  arcface_scale: 64.0

# Transform configuration
transform:
  input_size: 112  # Standard face recognition size
  normalize_mean: [0.5, 0.5, 0.5]  # Map to [-1, 1]
  normalize_std: [0.5, 0.5, 0.5]
  augmentation:
    horizontal_flip: 0.5
    random_crop: false
    color_jitter:
      brightness: 0.1
      contrast: 0.1
      saturation: 0.1
      hue: 0.05

# Training configuration
training:
  batch_size: 64
  learning_rate: 0.01  # With differential_lr, head gets 0.1
  differential_lr: true  # 1x backbone, 10x head
  optimizer: "sgd"  # SGD works well for face recognition
  momentum: 0.9
  weight_decay: 0.0005
  max_epochs: 30
  early_stop_patience: 10

  # Learning rate schedule
  scheduler:
    type: "multistep"
    milestones: [10, 18, 24]
    gamma: 0.1

# Telemetry configuration
telemetry:
  enabled: true
  collect_every_n: 100
  track_embeddings: false  # Can be expensive
  track_arcface_weights: true

# Output configuration
output_dir: null  # Will be auto-generated if null
save_embeddings: true
checkpoint_interval: 5  # Save checkpoint every N epochs

# Logging
log_interval: 100  # Log every N batches

# Debug/testing options (comment out for full training)
# max_batches: 10  # Limit batches per epoch for testing
