# Face Recognition Training Configuration
# Dataset: CASIA-WebFace (112x112)
# Model: ResNet-50 + ArcFace

# Reproducibility
seed: 42

# Device configuration
device: "cpu"  # or "cpu"

# Data configuration
data:
  data_format: "recordio"
  rec_path: "D:/DataSets/faces_webface_112x112/train.rec"
  num_classes: 10572  # CASIA-WebFace identities
  val_ratio: 0.1  # 10% identities held out for validation
  num_workers: 0

  # LFW verification benchmark
  lfw_bin: "D:/DataSets/faces_webface_112x112/lfw.bin"

  # PK sampling for better identity diversity per batch
  sampler:
    type: "pk"  # or "random"
    p_identities: 16
    k_images: 4

# Model configuration
model:
  backbone: "resnet50"
  pretrained: true
  embedding_dim: 512
  num_classes: 10572  # Will be updated based on train split
  dropout: 0.0
  arcface_margin: 0.5
  arcface_scale: 64.0

# Transform configuration
transform:
  input_size: 112
  normalize_mean: [0.5, 0.5, 0.5]
  normalize_std: [0.5, 0.5, 0.5]
  augmentation:
    horizontal_flip: 0.5
    random_crop: false
    color_jitter:
      brightness: 0.1
      contrast: 0.1
      saturation: 0.1
      hue: 0.05

# Training configuration
training:
  batch_size: 128
  learning_rate: 0.001
  differential_lr: true
  optimizer: "sgd"
  momentum: 0.9
  weight_decay: 0.0005
  max_epochs: 30

  scheduler:
    type: "multistep"
    milestones: [10, 18, 24]
    gamma: 0.1
    warmup_epochs: 1

# Validation configuration
verification_interval: 5  # Run LFW verification every N epochs

# Output configuration
output_dir: null
checkpoint_interval: 5
log_interval: 100

# Debug options
# max_batches: 10
