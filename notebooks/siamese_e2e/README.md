# Siamese E2E Model Analysis Notebooks

This directory contains notebooks for analyzing the Siamese E2E model behavior.

## Main Notebook

### `explore_model_behavior.ipynb`

**Updated: January 2026** - Now works with the **unified benchmark system**.

Analyzes the performance of multiple image quality models on synthetic degradations:
- **Siamese E2E** (trained on PhotoTriage)
- **AVA ResNet** (aesthetic scores)
- **Rule-Based IQA** (hand-crafted features)

**Data Source**: `outputs/benchmark_ava_vs_siamese/unified_results.csv`

**Generated by**: `scripts/image_quality_utilities/test_model_degradations.py`

## Contents

The notebook provides:
1. **Training history** - Siamese model training curves
2. **Overall comparison** - Accuracy and confidence by model
3. **Degradation analysis** - Performance breakdown by degradation type
4. **AVA score drops** - How much scores decrease with degradation
5. **Key insights** - Model specializations and recommendations

## Running the Benchmark

Before using the notebook, run the unified benchmark:

```bash
python scripts/image_quality_utilities/test_model_degradations.py \
    --config configs/image_quality_benchmarks/degradation_test.yaml
```

This will:
- Test 50 PhotoTriage images
- Generate 1,350 degraded variants (blur, JPEG, exposure, crops)
- Evaluate all 3 models
- Save results to `outputs/benchmark_ava_vs_siamese/`

## Results Summary

Quick results preview:
- **Best Overall**: Siamese (89.9% accuracy)
- **Best for Crops**: Siamese (94-96%)
- **Best for Blur**: IQA (100%), AVA (92.5%)
- **Best for Exposure**: AVA (91%)

See `outputs/benchmark_ava_vs_siamese/KEY_TAKEAWAYS.md` for full summary.

## Migration Note

**Old system** (deprecated, removed):
- Script: `scripts/utilities/test_model_degradations.py` ❌
- Outputs: `outputs/model_exploration/` ❌
- Only tested Siamese + IQA

**New system** (current):
- Script: `scripts/image_quality_utilities/test_model_degradations.py` ✅
- Outputs: `outputs/benchmark_ava_vs_siamese/` ✅
- Tests Siamese + AVA + IQA in unified framework
